# AGENTS.md — 에이전트 개발 지침(개발 원칙)

본 문서는 본 저장소의 개발 지침을 단일 기준으로 정리한 문서입니다. 기능 설명과 사용법은 `WORKSPACE_MANUAL.md`(SSOT)를 참고하고, 개발 관련 원칙과 코딩/설계/작업 절차는 본 문서를 따릅니다.

---

## 1) 목표와 범위
- 목표: 단순하고 신뢰할 수 있는 업무 생산성 데스크톱 앱을 유지·개선한다.
- 범위: Python(tkinter) 기반 UI, 서비스 로직, SQLite 저장소, 스크린샷/OCR/클립보드/워크스페이스/템플릿/포맷 변환 기능 전반.

## 2) 기술 스택
- 언어: Python 3.9+
- UI: tkinter
- DB: SQLite (`todos.db`, `config.db`)
- 기타: `mss`, `Pillow`, `pytesseract`, `pyperclip`

## 3) 레이어드 구조 원칙
- `models/`: 순수 데이터 모델만 정의 (로직 최소화)
- `repositories/`: DB 접근(CRUD, 마이그레이션 포함). 비즈니스 로직 금지
- `services/`: 비즈니스 로직/도메인 규칙 수행. UI/DB 세부사항 모름
- `ui/`: 화면, 이벤트 바인딩, 사용자 상호작용. 비즈니스는 서비스에 위임
- `main.py`: 앱 조립과 서비스 초기화, 탭 구성

## 4) 핵심 설계 원칙(SOLID)
- SRP(단일 책임): UI, 서비스, 저장소, 모델 책임을 엄격히 분리한다.
- OCP(개방-폐쇄): 기능 추가는 확장(새 클래스/메서드)으로, 기존 코드 변경은 최소화한다.
- LSP(리스코프 치환): 서비스가 의존하는 저장소는 동일 계약을 지켜 대체 가능해야 한다.
- ISP(인터페이스 분리): 저장소/서비스는 필요한 메서드만 제공하며, 거대한 다기능 인터페이스를 지양한다.
- DIP(의존성 역전): 상위(서비스/UI)는 하위 구현에 직접 의존하지 않도록 구성(주입)한다.

## 5) 코딩 원칙(클린 코드 / DRY / KISS)
- DRY: 중복 로직은 공용 함수/서비스로 추출한다.
- KISS: 과도한 추상화·메타프로그래밍을 피하고, 단순한 자료구조/흐름을 선호한다.
- 가독성: 의미 있는 이름, 일관된 네이밍(`snake_case`), 한 함수는 하나의 역할.
- 타입 힌트/Docstring: 공개 API·서비스에 타입 힌트와 간단 Docstring을 제공한다.
- 예외 처리: 사용자 영향(파일/경로/외부 실행) 지점은 `try/except`로 보호하고, UI는 친화적 메시지, 서비스는 메시지/예외를 반환한다.
- OS 의존 코드: 분기(`win32/darwin/linux`)는 서비스 메서드에 캡슐화한다.

## 6) DB 및 마이그레이션 지침
- SQLite 파일: `todos.db`(할 일), `config.db`(워크스페이스/템플릿) 사용.
- 테이블 생성: 앱 시작 시 존재하지 않으면 생성.
- 점진적 마이그레이션: 
  - `ALTER TABLE ... ADD COLUMN`은 idempotent하게 시도하고 이미 존재 시 무시한다. (예: `repositories/todo_repository.py`의 `TodoRepository._migrate()`)
  - 스키마 재작성 필요한 경우 임시 테이블로 rename→신규 생성→데이터 복사→원본 삭제 패턴을 사용한다. (예: `repositories/launcher_repository.py`의 `LauncherRepository.upgrade_schema()`가 해당)
- 데이터 보존: 파괴적 변경 전엔 백업 권장. 마이그레이션은 가능한 한 자동화한다.

## 7) 작업 원칙(프로세스)
- 합의 기반 변경: 구조/규칙 변경은 사전 공유·합의 후 진행.
- 투명 커뮤니케이션: “무엇을/왜/어떻게”를 커밋 메시지와 변경 요약에 남긴다.
- 오류 보고: 재현 절차, 기대/실제 결과, 로그/스크린샷, 환경 정보를 함께 기록.
- 작은 단위 커밋: 한 변경 집합을 작게 유지하고, 되돌리기 쉬운 형태로 나눈다.
- 변경 로그: 사용자 관점 변경 사항은 `WORKSPACE_MANUAL.md`의 “변경 로그(요약)” 섹션을 갱신한다.
- 문서 정책: 기능/사용 문서는 `WORKSPACE_MANUAL.md`, 개발 지침은 `AGENTS.md`. 중복 문서 금지.

## 8) 품질 체크리스트(개발자용)
- [ ] 레이어 경계 준수(UI↔서비스↔저장소)
- [ ] 예외/에러 메시지 한글화 및 사용자 친화성
- [ ] 외부 경로/프로세스 호출에 대한 오류 처리
- [ ] DB 마이그레이션 idempotent함 검증
- [ ] 공통 로직 DRY 적용 여부
- [ ] Docstring/타입힌트/가독성 확인
- [ ] OS 분기 및 경로 처리 안전성

## 9) 보안·안전
- 파일/프로세스 실행은 사용자의 명시적 동작을 통해서만 수행한다.
- 외부 경로/URL 실행 전 유효성·존재 확인을 우선한다.
- 민감 정보는 코드/문서에 하드코딩하지 않는다.

## 10) 참고
- 사용자/운영 문서: `WORKSPACE_MANUAL.md`
- 빠른 시작: `README.md`
- 의존성: `requirements.txt`

---

이 문서는 저장소 내 개발 활동의 기준이며, 변경이 필요한 경우 변경 이유와 영향 범위를 명확히 한 후 갱신합니다.
